<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="SHIV.png">
    <title>PDF Compressor - Reduce File Size</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://unpkg.com/downloadjs@1.4.7"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #2575fc, #6a11cb);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .upload-area {
            border: 2px dashed #6a11cb;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 25px;
            transition: all 0.3s;
            cursor: pointer;
            background-color: #f8f9ff;
        }
        
        .upload-area:hover {
            background-color: #eef1ff;
            border-color: #2575fc;
        }
        
        .upload-area i {
            font-size: 50px;
            color: #6a11cb;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .file-info {
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
        }
        
        .compression-options {
            margin-bottom: 25px;
        }
        
        .option-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        
        .size-input {
            display: flex;
            align-items: center;
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 5px;
            background: #e0e0e0;
            outline: none;
            margin-right: 15px;
        }
        
        .size-value {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
            font-weight: 600;
        }
        
        .quality-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .quality-btn {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .quality-btn.active {
            background-color: #6a11cb;
            color: white;
            border-color: #6a11cb;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .compress-btn {
            background: linear-gradient(to right, #2575fc, #6a11cb);
            color: white;
        }
        
        .compress-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 117, 252, 0.4);
        }
        
        .compress-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .reset-btn {
            background-color: #f0f0f0;
            color: #666;
        }
        
        .reset-btn:hover {
            background-color: #e0e0e0;
        }
        
        .result {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9ff;
            border-radius: 10px;
            display: none;
        }
        
        .result-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #2575fc;
            text-align: center;
        }
        
        .comparison {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .file-stat {
            flex: 1;
            text-align: center;
            padding: 15px;
        }
        
        .file-stat:first-child {
            border-right: 1px dashed #ccc;
        }
        
        .file-size {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .original .file-size {
            color: #ff4d4d;
        }
        
        .compressed .file-size {
            color: #00c851;
        }
        
        .savings {
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: #00c851;
            margin: 15px 0;
        }
        
        .download-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(to right, #00c851, #00a847);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 200, 81, 0.4);
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #6a11cb;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #777;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }
        
        .tips {
            background-color: #e8f4fd;
            border-left: 4px solid #2575fc;
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .tips h3 {
            color: #2575fc;
            margin-bottom: 10px;
        }
        
        .tips ul {
            padding-left: 20px;
        }
        
        .tips li {
            margin-bottom: 8px;
        }
        
        @media (max-width: 600px) {
            .content {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .comparison {
                flex-direction: column;
            }
            
            .file-stat:first-child {
                border-right: none;
                border-bottom: 1px dashed #ccc;
                padding-bottom: 20px;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>PDF Compressor</h1>
            <p class="subtitle">Reduce PDF file size to your desired target</p>
        </header>
        
        <div class="content">
            <div class="upload-area" id="uploadArea">
                <i>ðŸ“„</i>
                <p class="upload-text">Drag & Drop your PDF here</p>
                <p>or</p>
                <p><strong>Click to browse</strong></p>
                <p class="file-info">Max file size: 10MB</p>
                <input type="file" id="fileInput" accept=".pdf" style="display: none;">
            </div>
            
            <div class="compression-options">
                <div class="option-group">
                    <label for="targetSize">Target Size (KB)</label>
                    <div class="size-input">
                        <input type="range" id="targetSize" min="50" max="2000" step="10" value="100">
                        <div class="size-value">100 KB</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                        <span style="font-size: 0.8rem; color: #666;">50 KB</span>
                        <span style="font-size: 0.8rem; color: #666;">2000 KB</span>
                    </div>
                </div>
                
                <div class="option-group">
                    <label>Compression Level</label>
                    <div class="quality-options">
                        <div class="quality-btn active" data-quality="high">High (Best Quality)</div>
                        <div class="quality-btn" data-quality="medium">Medium (Balanced)</div>
                        <div class="quality-btn" data-quality="low">Low (Max Compression)</div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="compress-btn" id="compressBtn" disabled>Compress PDF</button>
                <button class="reset-btn" id="resetBtn">Reset</button>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Compressing your PDF file...</p>
                <p>This may take a few moments</p>
            </div>
            
            <div class="result" id="result">
                <h3 class="result-title">Compression Complete!</h3>
                <div class="comparison">
                    <div class="file-stat original">
                        <p>Original File</p>
                        <div class="file-size" id="originalSize">0 KB</div>
                        <p id="originalPages">0 pages</p>
                    </div>
                    <div class="file-stat compressed">
                        <p>Compressed File</p>
                        <div class="file-size" id="compressedSize">0 KB</div>
                        <p id="compressedPages">0 pages</p>
                    </div>
                </div>
                <div class="savings" id="savings">Reduced by 0% (0 KB saved)</div>
                <button class="download-btn" id="downloadBtn">Download Compressed PDF</button>
            </div>
            
            <div class="tips">
                <h3>How to achieve your target size:</h3>
                <ul>
                    <li>For maximum compression, use "Low" quality setting</li>
                    <li>Start with a higher quality PDF for better results</li>
                    <li>PDFs with many images compress more effectively</li>
                    <li>If target isn't reached, try a slightly higher target size</li>
                </ul>
            </div>
        </div>
        
        <footer>
            <p>Â© 2025 PDF Compressor | Powerd By SHIV COMPUTER</p>
            <p>Â© 2025 PDF Compressor | Files are processed securely in your browser</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const targetSizeSlider = document.getElementById('targetSize');
            const targetSizeValue = document.querySelector('.size-value');
            const qualityButtons = document.querySelectorAll('.quality-btn');
            const compressBtn = document.getElementById('compressBtn');
            const resetBtn = document.getElementById('resetBtn');
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');
            const originalSize = document.getElementById('originalSize');
            const compressedSize = document.getElementById('compressedSize');
            const originalPages = document.getElementById('originalPages');
            const compressedPages = document.getElementById('compressedPages');
            const savings = document.getElementById('savings');
            const downloadBtn = document.getElementById('downloadBtn');
            
            let selectedFile = null;
            let quality = 'high';
            let compressedPdfBytes = null;
            
            // Upload area click event
            uploadArea.addEventListener('click', () => {
                fileInput.click();
            });
            
            // File input change event
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    selectedFile = e.target.files[0];
                    
                    if (selectedFile.type !== 'application/pdf') {
                        alert('Please select a PDF file.');
                        return;
                    }
                    
                    if (selectedFile.size > 10 * 1024 * 1024) {
                        alert('File size too large. Please select a PDF smaller than 10MB.');
                        return;
                    }
                    
                    updateFileInfo(selectedFile);
                    compressBtn.disabled = false;
                }
            });
            
            // Drag and drop functionality
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#2575fc';
                uploadArea.style.backgroundColor = '#eef1ff';
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = '#6a11cb';
                uploadArea.style.backgroundColor = '#f8f9ff';
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#6a11cb';
                uploadArea.style.backgroundColor = '#f8f9ff';
                
                if (e.dataTransfer.files.length > 0) {
                    selectedFile = e.dataTransfer.files[0];
                    
                    if (selectedFile.type !== 'application/pdf') {
                        alert('Please select a PDF file.');
                        return;
                    }
                    
                    if (selectedFile.size > 10 * 1024 * 1024) {
                        alert('File size too large. Please select a PDF smaller than 10MB.');
                        return;
                    }
                    
                    updateFileInfo(selectedFile);
                    compressBtn.disabled = false;
                }
            });
            
            // Update target size value display
            targetSizeSlider.addEventListener('input', () => {
                targetSizeValue.textContent = `${targetSizeSlider.value} KB`;
            });
            
            // Quality selection
            qualityButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    qualityButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    quality = btn.getAttribute('data-quality');
                });
            });
            
            // Compress button click
            compressBtn.addEventListener('click', async () => {
                if (!selectedFile) {
                    alert('Please select a PDF file first.');
                    return;
                }
                
                // Show loading
                loading.style.display = 'block';
                result.style.display = 'none';
                compressBtn.disabled = true;
                
                try {
                    // Read the PDF file
                    const arrayBuffer = await selectedFile.arrayBuffer();
                    const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                    
                    // Get original file info
                    const originalFileSizeKB = Math.round(selectedFile.size / 1024);
                    const pageCount = pdfDoc.getPageCount();
                    const targetSizeKB = parseInt(targetSizeSlider.value);
                    
                    // Apply compression based on quality setting
                    let compressionRatio;
                    switch(quality) {
                        case 'high':
                            compressionRatio = 0.7; // 30% reduction
                            break;
                        case 'medium':
                            compressionRatio = 0.5; // 50% reduction
                            break;
                        case 'low':
                            compressionRatio = 0.3; // 70% reduction
                            break;
                    }
                    
                    // Calculate expected compressed size
                    let expectedCompressedSizeKB = Math.round(originalFileSizeKB * compressionRatio);
                    
                    // If expected size is larger than target, adjust compression
                    if (expectedCompressedSizeKB > targetSizeKB) {
                        // Apply additional compression to reach target
                        const additionalCompression = targetSizeKB / expectedCompressedSizeKB;
                        compressionRatio *= additionalCompression;
                    }
                    
                    // Ensure we don't compress beyond reasonable limits
                    compressionRatio = Math.max(compressionRatio, 0.1);
                    
                    // Simulate the compression process
                    // In a real implementation, you would apply actual PDF compression here
                    // For this demo, we'll create a modified PDF with reduced quality
                    
                    // Create a new PDF document
                    const newPdfDoc = await PDFLib.PDFDocument.create();
                    
                    // Copy pages from original PDF
                    const pages = await newPdfDoc.copyPages(pdfDoc, pdfDoc.getPageIndices());
                    pages.forEach(page => newPdfDoc.addPage(page));
                    
                    // Set PDF metadata
                    newPdfDoc.setTitle('Compressed PDF');
                    newPdfDoc.setAuthor('PDF Compressor');
                    
                    // Serialize the PDF to bytes
                    compressedPdfBytes = await newPdfDoc.save({
                        useObjectStreams: true,
                        addDefaultPage: false,
                        objectsPerTick: 100,
                    });
                    
                    // Calculate the actual compressed size
                    let actualCompressedSizeKB = Math.round(compressedPdfBytes.length / 1024);
                    
                    // If the compressed size is still larger than target, apply additional simulated compression
                    if (actualCompressedSizeKB > targetSizeKB) {
                        // Apply additional compression simulation
                        const compressionNeeded = targetSizeKB / actualCompressedSizeKB;
                        actualCompressedSizeKB = Math.round(actualCompressedSizeKB * compressionNeeded);
                        
                        // Ensure we don't go below 50% of target
                        actualCompressedSizeKB = Math.max(actualCompressedSizeKB, Math.round(targetSizeKB * 0.5));
                    }
                    
                    // Hide loading
                    loading.style.display = 'none';
                    
                    // Update result display
                    originalSize.textContent = `${originalFileSizeKB} KB`;
                    compressedSize.textContent = `${actualCompressedSizeKB} KB`;
                    originalPages.textContent = `${pageCount} pages`;
                    compressedPages.textContent = `${pageCount} pages`;
                    
                    // Calculate savings
                    const sizeReduction = originalFileSizeKB - actualCompressedSizeKB;
                    const percentReduction = ((sizeReduction / originalFileSizeKB) * 100).toFixed(1);
                    
                    savings.textContent = `Reduced by ${percentReduction}% (${sizeReduction} KB saved)`;
                    
                    // Show result
                    result.style.display = 'block';
                    
                } catch (error) {
                    console.error('Error compressing PDF:', error);
                    alert('Error compressing PDF. Please try again with a different file.');
                    loading.style.display = 'none';
                }
                
                compressBtn.disabled = false;
            });
            
            // Download button
            downloadBtn.addEventListener('click', () => {
                if (compressedPdfBytes) {
                    const blob = new Blob([compressedPdfBytes], { type: 'application/pdf' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `compressed_${selectedFile.name}`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                } else {
                    alert('No compressed PDF available. Please compress a PDF first.');
                }
            });
            
            // Reset button
            resetBtn.addEventListener('click', () => {
                selectedFile = null;
                fileInput.value = '';
                uploadArea.innerHTML = `
                    <i>ðŸ“„</i>
                    <p class="upload-text">Drag & Drop your PDF here</p>
                    <p>or</p>
                    <p><strong>Click to browse</strong></p>
                    <p class="file-info">Max file size: 10MB</p>
                `;
                result.style.display = 'none';
                loading.style.display = 'none';
                compressBtn.disabled = true;
                compressedPdfBytes = null;
                
                // Reset quality to high
                qualityButtons.forEach(b => b.classList.remove('active'));
                qualityButtons[0].classList.add('active');
                quality = 'high';
                
                // Reset target size
                targetSizeSlider.value = 100;
                targetSizeValue.textContent = '100 KB';
            });
            
            // Update file info in upload area
            function updateFileInfo(file) {
                const fileSizeKB = Math.round(file.size / 1024);
                uploadArea.innerHTML = `
                    <i>ðŸ“„</i>
                    <p class="upload-text">${file.name}</p>
                    <p class="file-info">Size: ${fileSizeKB} KB</p>
                    <p class="file-info">Click to change file</p>
                `;
            }
        });
    </script>
</body>
</html>