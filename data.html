<!DOCTYPE html>
<html>
<head>
    <title>Data Entry</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <link rel="icon" type="image/png" href="SHIV.png">
    
    <script src="https://raw.githack.com/js-wac/jsPDF-Devanagari-Font/main/NotoSansDevanagari.js"></script>

    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f4; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        
        /* Form Field Layout (3 Columns) */
        .form-fields { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px; }
        .form-group { flex: 1 1 30%; min-width: 250px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; }
        .form-group input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }

        /* Buttons and Export Area */
        .action-area { display: flex; gap: 10px; margin-top: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .action-area button { padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: background-color 0.3s; }
        
        /* Button Styles (‡§Ö‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§ø‡§§) */
        #saveBtn { background-color: #28a745; color: white; } 
        #saveBtn:hover { background-color: #1e7e34; }
        #clearFormBtn { background-color: #f0ad4e; color: white; } 
        #clearFormBtn:hover { background-color: #ec971f; }
        #printBtn { background-color: #007bff; color: white; }
        #printBtn:hover { background-color: #0056b3; }
        #pdfBtn { background-color: #dc3545; color: white; } 
        #pdfBtn:hover { background-color: #c82333; }
        #excelBtn { background-color: #ffc107; color: #333; } 
        #excelBtn:hover { background-color: #e0a800; }
        #resetBtn { background-color: #6c757d; color: white; } 
        #resetBtn:hover { background-color: #5a6268; }

        /* Table Style */
        table { width: 100%; border-collapse: collapse; margin-top: 30px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #007bff; color: white; }
        
        /* Print Styles */
        @media print {
            .hide-on-print { display: none; }
            .container { box-shadow: none; padding: 0; margin: 0; max-width: none; background: white; }
            table { margin-top: 0 !important; }
        }
    </style>
</head>
<body>

<div class="container">
    
    <div class="hide-on-print">
        <h2>1. ‡§®‡§Ø‡§æ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§è‡§Ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç</h2>
        
        <form id="recordForm">
            <div class="form-fields">
                <div class="form-group"><label for="name">‡§®‡§æ‡§Æ:</label><input type="text" id="name" required></div>
                <div class="form-group"><label for="fatherName">‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ:</label><input type="text" id="fatherName" required></div>
                <div class="form-group"><label for="motherName">‡§Æ‡§æ‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ:</label><input type="text" id="motherName" required></div>
                <div class="form-group"><label for="mobile">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞:</label><input type="text" id="mobile" required></div>
                <div class="form-group"><label for="address">‡§™‡§§‡§æ:</label><input type="text" id="address" required></div>
                <div class="form-group"><label for="class">‡§ï‡§ï‡•ç‡§∑‡§æ:</label><input type="text" id="class" required></div>
                <div class="form-group"><label for="pen">PEN:</label><input type="text" id="pen" required></div>
            </div>

            <div class="action-area">
                <button type="submit" id="saveBtn">‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
                <button type="button" id="clearFormBtn">‡§´‡§º‡•â‡§∞‡•ç‡§Æ ‡§ï‡•ç‡§≤‡§ø‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç üßπ</button> 
            </div>
        </form>

        <hr style="margin: 30px 0;">

        <h2>2. ‡§∏‡•á‡§µ ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•Å‡§Ü ‡§°‡•á‡§ü‡§æ</h2>

        <div class="action-area">
            <button id="printBtn">‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§∞‡•á‡§Ç üñ®Ô∏è</button>
            <button id="pdfBtn">PDF ‡•û‡§æ‡§á‡§≤ ‡§¨‡§®‡§æ‡§è‡§Å üìÑ</button>
            <button id="excelBtn">Excel ‡•û‡§æ‡§á‡§≤ ‡§¨‡§®‡§æ‡§è‡§Å (CSV) üìä</button>
            <button id="resetBtn">‡§≤‡•ã‡§ï‡§≤ ‡§°‡•á‡§ü‡§æ ‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ï‡§∞‡•á‡§Ç üóëÔ∏è</button>
        </div>
    </div>

    <table id="dataTable">
        <thead>
            <tr>
                <th>‡§®‡§æ‡§Æ</th>
                <th>‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
                <th>‡§Æ‡§æ‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
                <th>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞</th>
                <th>‡§™‡§§‡§æ</th>
                <th>‡§ï‡§ï‡•ç‡§∑‡§æ</th>
                <th>PEN</th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>
</div>

<script>
    const form = document.getElementById('recordForm');
    const dataTable = document.getElementById('dataTable');
    const dataTableBody = dataTable.querySelector('tbody');
    const storageKey = 'threeColDataRecords';

    // --- ‡§¨‡§ü‡§® ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡§®‡§∞ ---
    document.getElementById('printBtn').addEventListener('click', printTable);
    document.getElementById('pdfBtn').addEventListener('click', exportPDF);
    document.getElementById('excelBtn').addEventListener('click', exportCSV);
    document.getElementById('resetBtn').addEventListener('click', resetData);
    document.getElementById('clearFormBtn').addEventListener('click', clearForm);
    form.addEventListener('submit', handleFormSubmit);

    // --- ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ---

    function loadAndDisplayData() {
        const records = JSON.parse(localStorage.getItem(storageKey)) || [];
        dataTableBody.innerHTML = ''; 

        records.forEach(record => {
            const row = dataTableBody.insertRow();
            row.insertCell().textContent = record.name;
            row.insertCell().textContent = record.fatherName;
            row.insertCell().textContent = record.motherName;
            row.insertCell().textContent = record.mobile;
            row.insertCell().textContent = record.address;
            row.insertCell().textContent = record.class;
            row.insertCell().textContent = record.pen;
        });
    }

    function handleFormSubmit(event) {
        event.preventDefault(); 
        
        const newRecord = {
            name: document.getElementById('name').value,
            fatherName: document.getElementById('fatherName').value,
            motherName: document.getElementById('motherName').value,
            mobile: document.getElementById('mobile').value,
            address: document.getElementById('address').value,
            class: document.getElementById('class').value,
            pen: document.getElementById('pen').value
        };

        const records = JSON.parse(localStorage.getItem(storageKey)) || [];
        records.push(newRecord);
        localStorage.setItem(storageKey, JSON.stringify(records));
        
        form.reset();
        loadAndDisplayData();
        alert("‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§≤‡•ã‡§ï‡§≤ ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§Ø‡§æ! üíæ");
    }
    
    function clearForm() {
        form.reset();
        alert("‡§´‡§º‡•â‡§∞‡•ç‡§Æ ‡§´‡§º‡•Ä‡§≤‡•ç‡§°‡•ç‡§∏ ‡§ï‡•ç‡§≤‡§ø‡§Ø‡§∞ ‡§ï‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§π‡•à‡§Ç‡•§");
    }

    function resetData() {
        const confirmReset = confirm("‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§≤‡•ã‡§ï‡§≤ ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§∏‡•á ‡§∏‡§≠‡•Ä ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç? ‡§Ø‡§π ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à ‡§µ‡§æ‡§™‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§≤‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä‡•§");
        if (confirmReset) {
            localStorage.removeItem(storageKey);
            loadAndDisplayData(); 
            alert("‡§∏‡§≠‡•Ä ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ï‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§π‡•à‡§Ç‡•§");
        }
    }

    function printTable() {
        window.print(); 
    }

    // 6. PDF ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® (‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§´‡§º‡•â‡§®‡•ç‡§ü ‡§´‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ)
    function exportPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('l', 'pt', 'a4'); // 'l' for landscape mode

        // ‡§´‡§º‡•â‡§®‡•ç‡§ü ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§ú‡•ã ‡§π‡§Æ‡§®‡•á ‡§ä‡§™‡§∞ ‡§ú‡•ã‡§°‡§º‡§æ ‡§π‡•à (Noto Sans Devanagari)
        doc.setFont('NotoSansDevanagari', 'normal');

        doc.autoTable({ 
            html: '#dataTable',
            startY: 40,
            headStyles: { fillColor: [0, 123, 255], font: 'NotoSansDevanagari' }, // Header ‡§´‡§º‡•â‡§®‡•ç‡§ü ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
            styles: { font: 'NotoSansDevanagari', halign: 'left', fontSize: 8 }, // Body ‡§´‡§º‡•â‡§®‡•ç‡§ü ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
            didDrawPage: function(data) {
                // ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï ‡§ú‡•ã‡§°‡§º‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§≠‡•Ä ‡§´‡§º‡•â‡§®‡•ç‡§ü ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡§æ ‡§® ‡§≠‡•Ç‡§≤‡•á‡§Ç
                doc.setFont('NotoSansDevanagari', 'normal');
                doc.text("‡§∏‡•á‡§µ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡•ç‡§∏ ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ", 40, 30);
            }
        });
        
        doc.save('Student_Records_PDF.pdf');
    }

    // 7. Excel (CSV) ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® (‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§´‡§º‡•â‡§®‡•ç‡§ü ‡§´‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§•)
    function exportCSV() {
        const records = JSON.parse(localStorage.getItem(storageKey)) || [];
        if (records.length === 0) {
            alert("‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à!");
            return;
        }

        const headers = ["‡§®‡§æ‡§Æ", "‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ", "‡§Æ‡§æ‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ", "‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞", "‡§™‡§§‡§æ", "‡§ï‡§ï‡•ç‡§∑‡§æ", "PEN"];
        
        let csv = headers.join(',') + '\n';
        
        records.forEach(record => {
            const row = [
                record.name,
                record.fatherName,
                record.motherName,
                record.mobile,
                record.address,
                record.class,
                record.pen
            ].map(item => {
                let cleanItem = item.replace(/"/g, '""'); 
                return `"${cleanItem}"`; 
            }).join(','); 
            
            csv += row + '\n';
        });

        // ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§´‡§º‡•â‡§®‡•ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡§ø‡§ï‡•ç‡§∏: UTF-8 BOM ‡§ú‡•ã‡§°‡§º‡§®‡§æ
        const BOM = "\uFEFF"; 
        const finalCSV = BOM + csv;

        const blob = new Blob([finalCSV], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement("a");
        
        link.href = URL.createObjectURL(blob);
        link.setAttribute('download', 'Student_Records_Excel.csv');
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    window.onload = loadAndDisplayData;
</script>

</body>
</html>